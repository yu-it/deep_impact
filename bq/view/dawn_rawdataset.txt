select
concat(format_datetime("%F",bac.date),"_",kyi.race_key_place_code,kyi.race_key_round) as primary_key,
kyi.race_key_place_code,
kyi.race_key_year,
kyi.race_key_no,
kyi.race_key_day,
kyi.race_key_round,
max(cat_place.meaning) as place_name,
max(bac.date) as date,
max(bac.race_condition_distance) as race_condition_distance,
max(bac.race_condition_track_grass_dart_etc) as race_condition_track_grass_dart_etc,
max(bac.race_condition_condition) as race_condition_condition,
max(bac.horse_count) as horse_count,
max(kab.weather_code) as weather_code,
max(kab.grass_field_status_code) as grass_field_status_code,
max(kab.dart_field_status_code) as dart_field_status_code,
max(case when kyi.horse_no = '01' then kyi.register_no else '' end) as register_no_01,
max(case when kyi.horse_no = '02' then kyi.register_no else '' end) as register_no_02,
max(case when kyi.horse_no = '03' then kyi.register_no else '' end) as register_no_03,
max(case when kyi.horse_no = '04' then kyi.register_no else '' end) as register_no_04,
max(case when kyi.horse_no = '05' then kyi.register_no else '' end) as register_no_05,
max(case when kyi.horse_no = '06' then kyi.register_no else '' end) as register_no_06,
max(case when kyi.horse_no = '07' then kyi.register_no else '' end) as register_no_07,
max(case when kyi.horse_no = '08' then kyi.register_no else '' end) as register_no_08,
max(case when kyi.horse_no = '09' then kyi.register_no else '' end) as register_no_09,
max(case when kyi.horse_no = '10' then kyi.register_no else '' end) as register_no_10,
max(case when kyi.horse_no = '11' then kyi.register_no else '' end) as register_no_11,
max(case when kyi.horse_no = '12' then kyi.register_no else '' end) as register_no_12,
max(case when kyi.horse_no = '13' then kyi.register_no else '' end) as register_no_13,
max(case when kyi.horse_no = '14' then kyi.register_no else '' end) as register_no_14,
max(case when kyi.horse_no = '15' then kyi.register_no else '' end) as register_no_15,
max(case when kyi.horse_no = '16' then kyi.register_no else '' end) as register_no_16,
max(case when kyi.horse_no = '17' then kyi.register_no else '' end) as register_no_17,
max(case when kyi.horse_no = '18' then kyi.register_no else '' end) as register_no_18,
max(case when kyi.horse_no = '01' then kyi.horse_name else '' end) as horse_name_01,
max(case when kyi.horse_no = '02' then kyi.horse_name else '' end) as horse_name_02,
max(case when kyi.horse_no = '03' then kyi.horse_name else '' end) as horse_name_03,
max(case when kyi.horse_no = '04' then kyi.horse_name else '' end) as horse_name_04,
max(case when kyi.horse_no = '05' then kyi.horse_name else '' end) as horse_name_05,
max(case when kyi.horse_no = '06' then kyi.horse_name else '' end) as horse_name_06,
max(case when kyi.horse_no = '07' then kyi.horse_name else '' end) as horse_name_07,
max(case when kyi.horse_no = '08' then kyi.horse_name else '' end) as horse_name_08,
max(case when kyi.horse_no = '09' then kyi.horse_name else '' end) as horse_name_09,
max(case when kyi.horse_no = '10' then kyi.horse_name else '' end) as horse_name_10,
max(case when kyi.horse_no = '11' then kyi.horse_name else '' end) as horse_name_11,
max(case when kyi.horse_no = '12' then kyi.horse_name else '' end) as horse_name_12,
max(case when kyi.horse_no = '13' then kyi.horse_name else '' end) as horse_name_13,
max(case when kyi.horse_no = '14' then kyi.horse_name else '' end) as horse_name_14,
max(case when kyi.horse_no = '15' then kyi.horse_name else '' end) as horse_name_15,
max(case when kyi.horse_no = '16' then kyi.horse_name else '' end) as horse_name_16,
max(case when kyi.horse_no = '17' then kyi.horse_name else '' end) as horse_name_17,
max(case when kyi.horse_no = '18' then kyi.horse_name else '' end) as horse_name_18,
max(case when kyi.horse_no = '01' then kyi.IDM else null end) as IDM_01,
max(case when kyi.horse_no = '02' then kyi.IDM else null end) as IDM_02,
max(case when kyi.horse_no = '03' then kyi.IDM else null end) as IDM_03,
max(case when kyi.horse_no = '04' then kyi.IDM else null end) as IDM_04,
max(case when kyi.horse_no = '05' then kyi.IDM else null end) as IDM_05,
max(case when kyi.horse_no = '06' then kyi.IDM else null end) as IDM_06,
max(case when kyi.horse_no = '07' then kyi.IDM else null end) as IDM_07,
max(case when kyi.horse_no = '08' then kyi.IDM else null end) as IDM_08,
max(case when kyi.horse_no = '09' then kyi.IDM else null end) as IDM_09,
max(case when kyi.horse_no = '10' then kyi.IDM else null end) as IDM_10,
max(case when kyi.horse_no = '11' then kyi.IDM else null end) as IDM_11,
max(case when kyi.horse_no = '12' then kyi.IDM else null end) as IDM_12,
max(case when kyi.horse_no = '13' then kyi.IDM else null end) as IDM_13,
max(case when kyi.horse_no = '14' then kyi.IDM else null end) as IDM_14,
max(case when kyi.horse_no = '15' then kyi.IDM else null end) as IDM_15,
max(case when kyi.horse_no = '16' then kyi.IDM else null end) as IDM_16,
max(case when kyi.horse_no = '17' then kyi.IDM else null end) as IDM_17,
max(case when kyi.horse_no = '18' then kyi.IDM else null end) as IDM_18,
max(case when kyi.horse_no = '01' then kyi.jockey_index else null end) as jockey_index_01,
max(case when kyi.horse_no = '02' then kyi.jockey_index else null end) as jockey_index_02,
max(case when kyi.horse_no = '03' then kyi.jockey_index else null end) as jockey_index_03,
max(case when kyi.horse_no = '04' then kyi.jockey_index else null end) as jockey_index_04,
max(case when kyi.horse_no = '05' then kyi.jockey_index else null end) as jockey_index_05,
max(case when kyi.horse_no = '06' then kyi.jockey_index else null end) as jockey_index_06,
max(case when kyi.horse_no = '07' then kyi.jockey_index else null end) as jockey_index_07,
max(case when kyi.horse_no = '08' then kyi.jockey_index else null end) as jockey_index_08,
max(case when kyi.horse_no = '09' then kyi.jockey_index else null end) as jockey_index_09,
max(case when kyi.horse_no = '10' then kyi.jockey_index else null end) as jockey_index_10,
max(case when kyi.horse_no = '11' then kyi.jockey_index else null end) as jockey_index_11,
max(case when kyi.horse_no = '12' then kyi.jockey_index else null end) as jockey_index_12,
max(case when kyi.horse_no = '13' then kyi.jockey_index else null end) as jockey_index_13,
max(case when kyi.horse_no = '14' then kyi.jockey_index else null end) as jockey_index_14,
max(case when kyi.horse_no = '15' then kyi.jockey_index else null end) as jockey_index_15,
max(case when kyi.horse_no = '16' then kyi.jockey_index else null end) as jockey_index_16,
max(case when kyi.horse_no = '17' then kyi.jockey_index else null end) as jockey_index_17,
max(case when kyi.horse_no = '18' then kyi.jockey_index else null end) as jockey_index_18,
max(case when kyi.horse_no = '01' then kyi.info_index else null end) as info_index_01,
max(case when kyi.horse_no = '02' then kyi.info_index else null end) as info_index_02,
max(case when kyi.horse_no = '03' then kyi.info_index else null end) as info_index_03,
max(case when kyi.horse_no = '04' then kyi.info_index else null end) as info_index_04,
max(case when kyi.horse_no = '05' then kyi.info_index else null end) as info_index_05,
max(case when kyi.horse_no = '06' then kyi.info_index else null end) as info_index_06,
max(case when kyi.horse_no = '07' then kyi.info_index else null end) as info_index_07,
max(case when kyi.horse_no = '08' then kyi.info_index else null end) as info_index_08,
max(case when kyi.horse_no = '09' then kyi.info_index else null end) as info_index_09,
max(case when kyi.horse_no = '10' then kyi.info_index else null end) as info_index_10,
max(case when kyi.horse_no = '11' then kyi.info_index else null end) as info_index_11,
max(case when kyi.horse_no = '12' then kyi.info_index else null end) as info_index_12,
max(case when kyi.horse_no = '13' then kyi.info_index else null end) as info_index_13,
max(case when kyi.horse_no = '14' then kyi.info_index else null end) as info_index_14,
max(case when kyi.horse_no = '15' then kyi.info_index else null end) as info_index_15,
max(case when kyi.horse_no = '16' then kyi.info_index else null end) as info_index_16,
max(case when kyi.horse_no = '17' then kyi.info_index else null end) as info_index_17,
max(case when kyi.horse_no = '18' then kyi.info_index else null end) as info_index_18,
max(case when kyi.horse_no = '01' then kyi.comprehension_index else null end) as comprehension_index_01,
max(case when kyi.horse_no = '02' then kyi.comprehension_index else null end) as comprehension_index_02,
max(case when kyi.horse_no = '03' then kyi.comprehension_index else null end) as comprehension_index_03,
max(case when kyi.horse_no = '04' then kyi.comprehension_index else null end) as comprehension_index_04,
max(case when kyi.horse_no = '05' then kyi.comprehension_index else null end) as comprehension_index_05,
max(case when kyi.horse_no = '06' then kyi.comprehension_index else null end) as comprehension_index_06,
max(case when kyi.horse_no = '07' then kyi.comprehension_index else null end) as comprehension_index_07,
max(case when kyi.horse_no = '08' then kyi.comprehension_index else null end) as comprehension_index_08,
max(case when kyi.horse_no = '09' then kyi.comprehension_index else null end) as comprehension_index_09,
max(case when kyi.horse_no = '10' then kyi.comprehension_index else null end) as comprehension_index_10,
max(case when kyi.horse_no = '11' then kyi.comprehension_index else null end) as comprehension_index_11,
max(case when kyi.horse_no = '12' then kyi.comprehension_index else null end) as comprehension_index_12,
max(case when kyi.horse_no = '13' then kyi.comprehension_index else null end) as comprehension_index_13,
max(case when kyi.horse_no = '14' then kyi.comprehension_index else null end) as comprehension_index_14,
max(case when kyi.horse_no = '15' then kyi.comprehension_index else null end) as comprehension_index_15,
max(case when kyi.horse_no = '16' then kyi.comprehension_index else null end) as comprehension_index_16,
max(case when kyi.horse_no = '17' then kyi.comprehension_index else null end) as comprehension_index_17,
max(case when kyi.horse_no = '18' then kyi.comprehension_index else null end) as comprehension_index_18,
max(case when kyi.horse_no = '01' then leg_status else '' end) as leg_status_01,
max(case when kyi.horse_no = '02' then leg_status else '' end) as leg_status_02,
max(case when kyi.horse_no = '03' then leg_status else '' end) as leg_status_03,
max(case when kyi.horse_no = '04' then leg_status else '' end) as leg_status_04,
max(case when kyi.horse_no = '05' then leg_status else '' end) as leg_status_05,
max(case when kyi.horse_no = '06' then leg_status else '' end) as leg_status_06,
max(case when kyi.horse_no = '07' then leg_status else '' end) as leg_status_07,
max(case when kyi.horse_no = '08' then leg_status else '' end) as leg_status_08,
max(case when kyi.horse_no = '09' then leg_status else '' end) as leg_status_09,
max(case when kyi.horse_no = '10' then leg_status else '' end) as leg_status_10,
max(case when kyi.horse_no = '11' then leg_status else '' end) as leg_status_11,
max(case when kyi.horse_no = '12' then leg_status else '' end) as leg_status_12,
max(case when kyi.horse_no = '13' then leg_status else '' end) as leg_status_13,
max(case when kyi.horse_no = '14' then leg_status else '' end) as leg_status_14,
max(case when kyi.horse_no = '15' then leg_status else '' end) as leg_status_15,
max(case when kyi.horse_no = '16' then leg_status else '' end) as leg_status_16,
max(case when kyi.horse_no = '17' then leg_status else '' end) as leg_status_17,
max(case when kyi.horse_no = '18' then leg_status else '' end) as leg_status_18,
max(case when kyi.horse_no = '01' then distance_apptitude else '' end) as distance_apptitude_01,
max(case when kyi.horse_no = '02' then distance_apptitude else '' end) as distance_apptitude_02,
max(case when kyi.horse_no = '03' then distance_apptitude else '' end) as distance_apptitude_03,
max(case when kyi.horse_no = '04' then distance_apptitude else '' end) as distance_apptitude_04,
max(case when kyi.horse_no = '05' then distance_apptitude else '' end) as distance_apptitude_05,
max(case when kyi.horse_no = '06' then distance_apptitude else '' end) as distance_apptitude_06,
max(case when kyi.horse_no = '07' then distance_apptitude else '' end) as distance_apptitude_07,
max(case when kyi.horse_no = '08' then distance_apptitude else '' end) as distance_apptitude_08,
max(case when kyi.horse_no = '09' then distance_apptitude else '' end) as distance_apptitude_09,
max(case when kyi.horse_no = '10' then distance_apptitude else '' end) as distance_apptitude_10,
max(case when kyi.horse_no = '11' then distance_apptitude else '' end) as distance_apptitude_11,
max(case when kyi.horse_no = '12' then distance_apptitude else '' end) as distance_apptitude_12,
max(case when kyi.horse_no = '13' then distance_apptitude else '' end) as distance_apptitude_13,
max(case when kyi.horse_no = '14' then distance_apptitude else '' end) as distance_apptitude_14,
max(case when kyi.horse_no = '15' then distance_apptitude else '' end) as distance_apptitude_15,
max(case when kyi.horse_no = '16' then distance_apptitude else '' end) as distance_apptitude_16,
max(case when kyi.horse_no = '17' then distance_apptitude else '' end) as distance_apptitude_17,
max(case when kyi.horse_no = '18' then distance_apptitude else '' end) as distance_apptitude_18,
max(case when kyi.horse_no = '01' then kyi.torture_index else null end) as torture_index_01,
max(case when kyi.horse_no = '02' then kyi.torture_index else null end) as torture_index_02,
max(case when kyi.horse_no = '03' then kyi.torture_index else null end) as torture_index_03,
max(case when kyi.horse_no = '04' then kyi.torture_index else null end) as torture_index_04,
max(case when kyi.horse_no = '05' then kyi.torture_index else null end) as torture_index_05,
max(case when kyi.horse_no = '06' then kyi.torture_index else null end) as torture_index_06,
max(case when kyi.horse_no = '07' then kyi.torture_index else null end) as torture_index_07,
max(case when kyi.horse_no = '08' then kyi.torture_index else null end) as torture_index_08,
max(case when kyi.horse_no = '09' then kyi.torture_index else null end) as torture_index_09,
max(case when kyi.horse_no = '10' then kyi.torture_index else null end) as torture_index_10,
max(case when kyi.horse_no = '11' then kyi.torture_index else null end) as torture_index_11,
max(case when kyi.horse_no = '12' then kyi.torture_index else null end) as torture_index_12,
max(case when kyi.horse_no = '13' then kyi.torture_index else null end) as torture_index_13,
max(case when kyi.horse_no = '14' then kyi.torture_index else null end) as torture_index_14,
max(case when kyi.horse_no = '15' then kyi.torture_index else null end) as torture_index_15,
max(case when kyi.horse_no = '16' then kyi.torture_index else null end) as torture_index_16,
max(case when kyi.horse_no = '17' then kyi.torture_index else null end) as torture_index_17,
max(case when kyi.horse_no = '18' then kyi.torture_index else null end) as torture_index_18,
max(case when kyi.horse_no = '01' then kyi.passion_index else null end) as passion_index_01,
max(case when kyi.horse_no = '02' then kyi.passion_index else null end) as passion_index_02,
max(case when kyi.horse_no = '03' then kyi.passion_index else null end) as passion_index_03,
max(case when kyi.horse_no = '04' then kyi.passion_index else null end) as passion_index_04,
max(case when kyi.horse_no = '05' then kyi.passion_index else null end) as passion_index_05,
max(case when kyi.horse_no = '06' then kyi.passion_index else null end) as passion_index_06,
max(case when kyi.horse_no = '07' then kyi.passion_index else null end) as passion_index_07,
max(case when kyi.horse_no = '08' then kyi.passion_index else null end) as passion_index_08,
max(case when kyi.horse_no = '09' then kyi.passion_index else null end) as passion_index_09,
max(case when kyi.horse_no = '10' then kyi.passion_index else null end) as passion_index_10,
max(case when kyi.horse_no = '11' then kyi.passion_index else null end) as passion_index_11,
max(case when kyi.horse_no = '12' then kyi.passion_index else null end) as passion_index_12,
max(case when kyi.horse_no = '13' then kyi.passion_index else null end) as passion_index_13,
max(case when kyi.horse_no = '14' then kyi.passion_index else null end) as passion_index_14,
max(case when kyi.horse_no = '15' then kyi.passion_index else null end) as passion_index_15,
max(case when kyi.horse_no = '16' then kyi.passion_index else null end) as passion_index_16,
max(case when kyi.horse_no = '17' then kyi.passion_index else null end) as passion_index_17,
max(case when kyi.horse_no = '18' then kyi.passion_index else null end) as passion_index_18,
max(case when kyi.horse_no = '01' then kyi.load_weight else null end) as load_weight_01,
max(case when kyi.horse_no = '02' then kyi.load_weight else null end) as load_weight_02,
max(case when kyi.horse_no = '03' then kyi.load_weight else null end) as load_weight_03,
max(case when kyi.horse_no = '04' then kyi.load_weight else null end) as load_weight_04,
max(case when kyi.horse_no = '05' then kyi.load_weight else null end) as load_weight_05,
max(case when kyi.horse_no = '06' then kyi.load_weight else null end) as load_weight_06,
max(case when kyi.horse_no = '07' then kyi.load_weight else null end) as load_weight_07,
max(case when kyi.horse_no = '08' then kyi.load_weight else null end) as load_weight_08,
max(case when kyi.horse_no = '09' then kyi.load_weight else null end) as load_weight_09,
max(case when kyi.horse_no = '10' then kyi.load_weight else null end) as load_weight_10,
max(case when kyi.horse_no = '11' then kyi.load_weight else null end) as load_weight_11,
max(case when kyi.horse_no = '12' then kyi.load_weight else null end) as load_weight_12,
max(case when kyi.horse_no = '13' then kyi.load_weight else null end) as load_weight_13,
max(case when kyi.horse_no = '14' then kyi.load_weight else null end) as load_weight_14,
max(case when kyi.horse_no = '15' then kyi.load_weight else null end) as load_weight_15,
max(case when kyi.horse_no = '16' then kyi.load_weight else null end) as load_weight_16,
max(case when kyi.horse_no = '17' then kyi.load_weight else null end) as load_weight_17,
max(case when kyi.horse_no = '18' then kyi.load_weight else null end) as load_weight_18,
max(case when kyi.horse_no = '01' then kyi.prize_info_obtain_prize else null end) as prize_info_obtain_prize_01,
max(case when kyi.horse_no = '02' then kyi.prize_info_obtain_prize else null end) as prize_info_obtain_prize_02,
max(case when kyi.horse_no = '03' then kyi.prize_info_obtain_prize else null end) as prize_info_obtain_prize_03,
max(case when kyi.horse_no = '04' then kyi.prize_info_obtain_prize else null end) as prize_info_obtain_prize_04,
max(case when kyi.horse_no = '05' then kyi.prize_info_obtain_prize else null end) as prize_info_obtain_prize_05,
max(case when kyi.horse_no = '06' then kyi.prize_info_obtain_prize else null end) as prize_info_obtain_prize_06,
max(case when kyi.horse_no = '07' then kyi.prize_info_obtain_prize else null end) as prize_info_obtain_prize_07,
max(case when kyi.horse_no = '08' then kyi.prize_info_obtain_prize else null end) as prize_info_obtain_prize_08,
max(case when kyi.horse_no = '09' then kyi.prize_info_obtain_prize else null end) as prize_info_obtain_prize_09,
max(case when kyi.horse_no = '10' then kyi.prize_info_obtain_prize else null end) as prize_info_obtain_prize_10,
max(case when kyi.horse_no = '11' then kyi.prize_info_obtain_prize else null end) as prize_info_obtain_prize_11,
max(case when kyi.horse_no = '12' then kyi.prize_info_obtain_prize else null end) as prize_info_obtain_prize_12,
max(case when kyi.horse_no = '13' then kyi.prize_info_obtain_prize else null end) as prize_info_obtain_prize_13,
max(case when kyi.horse_no = '14' then kyi.prize_info_obtain_prize else null end) as prize_info_obtain_prize_14,
max(case when kyi.horse_no = '15' then kyi.prize_info_obtain_prize else null end) as prize_info_obtain_prize_15,
max(case when kyi.horse_no = '16' then kyi.prize_info_obtain_prize else null end) as prize_info_obtain_prize_16,
max(case when kyi.horse_no = '17' then kyi.prize_info_obtain_prize else null end) as prize_info_obtain_prize_17,
max(case when kyi.horse_no = '18' then kyi.prize_info_obtain_prize else null end) as prize_info_obtain_prize_18,
max(case when kyi.horse_no = '01' then sex else '' end) as sex_01,
max(case when kyi.horse_no = '02' then sex else '' end) as sex_02,
max(case when kyi.horse_no = '03' then sex else '' end) as sex_03,
max(case when kyi.horse_no = '04' then sex else '' end) as sex_04,
max(case when kyi.horse_no = '05' then sex else '' end) as sex_05,
max(case when kyi.horse_no = '06' then sex else '' end) as sex_06,
max(case when kyi.horse_no = '07' then sex else '' end) as sex_07,
max(case when kyi.horse_no = '08' then sex else '' end) as sex_08,
max(case when kyi.horse_no = '09' then sex else '' end) as sex_09,
max(case when kyi.horse_no = '10' then sex else '' end) as sex_10,
max(case when kyi.horse_no = '11' then sex else '' end) as sex_11,
max(case when kyi.horse_no = '12' then sex else '' end) as sex_12,
max(case when kyi.horse_no = '13' then sex else '' end) as sex_13,
max(case when kyi.horse_no = '14' then sex else '' end) as sex_14,
max(case when kyi.horse_no = '15' then sex else '' end) as sex_15,
max(case when kyi.horse_no = '16' then sex else '' end) as sex_16,
max(case when kyi.horse_no = '17' then sex else '' end) as sex_17,
max(case when kyi.horse_no = '18' then sex else '' end) as sex_18,
max(case when sed.horse_no = '01' then horse_performance_order else null end) as horse_performance_order_01,
max(case when sed.horse_no = '02' then horse_performance_order else null end) as horse_performance_order_02,
max(case when sed.horse_no = '03' then horse_performance_order else null end) as horse_performance_order_03,
max(case when sed.horse_no = '04' then horse_performance_order else null end) as horse_performance_order_04,
max(case when sed.horse_no = '05' then horse_performance_order else null end) as horse_performance_order_05,
max(case when sed.horse_no = '06' then horse_performance_order else null end) as horse_performance_order_06,
max(case when sed.horse_no = '07' then horse_performance_order else null end) as horse_performance_order_07,
max(case when sed.horse_no = '08' then horse_performance_order else null end) as horse_performance_order_08,
max(case when sed.horse_no = '09' then horse_performance_order else null end) as horse_performance_order_09,
max(case when sed.horse_no = '10' then horse_performance_order else null end) as horse_performance_order_10,
max(case when sed.horse_no = '11' then horse_performance_order else null end) as horse_performance_order_11,
max(case when sed.horse_no = '12' then horse_performance_order else null end) as horse_performance_order_12,
max(case when sed.horse_no = '13' then horse_performance_order else null end) as horse_performance_order_13,
max(case when sed.horse_no = '14' then horse_performance_order else null end) as horse_performance_order_14,
max(case when sed.horse_no = '15' then horse_performance_order else null end) as horse_performance_order_15,
max(case when sed.horse_no = '16' then horse_performance_order else null end) as horse_performance_order_16,
max(case when sed.horse_no = '17' then horse_performance_order else null end) as horse_performance_order_17,
max(case when sed.horse_no = '18' then horse_performance_order else null end) as horse_performance_order_18,
18 - ((max(case when sed.horse_no = '01' then horse_performance_order else null end) - 1) * (18 / count(1))) as horse_performance_order_01_reversed,
18 - ((max(case when sed.horse_no = '02' then horse_performance_order else null end) - 1) * (18 / count(1))) as horse_performance_order_02_reversed,
18 - ((max(case when sed.horse_no = '03' then horse_performance_order else null end) - 1) * (18 / count(1))) as horse_performance_order_03_reversed,
18 - ((max(case when sed.horse_no = '04' then horse_performance_order else null end) - 1) * (18 / count(1))) as horse_performance_order_04_reversed,
18 - ((max(case when sed.horse_no = '05' then horse_performance_order else null end) - 1) * (18 / count(1))) as horse_performance_order_05_reversed,
18 - ((max(case when sed.horse_no = '06' then horse_performance_order else null end) - 1) * (18 / count(1))) as horse_performance_order_06_reversed,
18 - ((max(case when sed.horse_no = '07' then horse_performance_order else null end) - 1) * (18 / count(1))) as horse_performance_order_07_reversed,
18 - ((max(case when sed.horse_no = '08' then horse_performance_order else null end) - 1) * (18 / count(1))) as horse_performance_order_08_reversed,
18 - ((max(case when sed.horse_no = '09' then horse_performance_order else null end) - 1) * (18 / count(1))) as horse_performance_order_09_reversed,
18 - ((max(case when sed.horse_no = '10' then horse_performance_order else null end) - 1) * (18 / count(1))) as horse_performance_order_10_reversed,
18 - ((max(case when sed.horse_no = '11' then horse_performance_order else null end) - 1) * (18 / count(1))) as horse_performance_order_11_reversed,
18 - ((max(case when sed.horse_no = '12' then horse_performance_order else null end) - 1) * (18 / count(1))) as horse_performance_order_12_reversed,
18 - ((max(case when sed.horse_no = '13' then horse_performance_order else null end) - 1) * (18 / count(1))) as horse_performance_order_13_reversed,
18 - ((max(case when sed.horse_no = '14' then horse_performance_order else null end) - 1) * (18 / count(1))) as horse_performance_order_14_reversed,
18 - ((max(case when sed.horse_no = '15' then horse_performance_order else null end) - 1) * (18 / count(1))) as horse_performance_order_15_reversed,
18 - ((max(case when sed.horse_no = '16' then horse_performance_order else null end) - 1) * (18 / count(1))) as horse_performance_order_16_reversed,
18 - ((max(case when sed.horse_no = '17' then horse_performance_order else null end) - 1) * (18 / count(1))) as horse_performance_order_17_reversed,
18 - ((max(case when sed.horse_no = '18' then horse_performance_order else null end) - 1) * (18 / count(1))) as horse_performance_order_18_reversed,
max(case when tyb.horse_no = '01' then gear_change_info else '' end) as gear_change_info_01,
max(case when tyb.horse_no = '02' then gear_change_info else '' end) as gear_change_info_02,
max(case when tyb.horse_no = '03' then gear_change_info else '' end) as gear_change_info_03,
max(case when tyb.horse_no = '04' then gear_change_info else '' end) as gear_change_info_04,
max(case when tyb.horse_no = '05' then gear_change_info else '' end) as gear_change_info_05,
max(case when tyb.horse_no = '06' then gear_change_info else '' end) as gear_change_info_06,
max(case when tyb.horse_no = '07' then gear_change_info else '' end) as gear_change_info_07,
max(case when tyb.horse_no = '08' then gear_change_info else '' end) as gear_change_info_08,
max(case when tyb.horse_no = '09' then gear_change_info else '' end) as gear_change_info_09,
max(case when tyb.horse_no = '10' then gear_change_info else '' end) as gear_change_info_10,
max(case when tyb.horse_no = '11' then gear_change_info else '' end) as gear_change_info_11,
max(case when tyb.horse_no = '12' then gear_change_info else '' end) as gear_change_info_12,
max(case when tyb.horse_no = '13' then gear_change_info else '' end) as gear_change_info_13,
max(case when tyb.horse_no = '14' then gear_change_info else '' end) as gear_change_info_14,
max(case when tyb.horse_no = '15' then gear_change_info else '' end) as gear_change_info_15,
max(case when tyb.horse_no = '16' then gear_change_info else '' end) as gear_change_info_16,
max(case when tyb.horse_no = '17' then gear_change_info else '' end) as gear_change_info_17,
max(case when tyb.horse_no = '18' then gear_change_info else '' end) as gear_change_info_18,
max(case when tyb.horse_no = '01' then leg_info else '' end) as leg_info_01,
max(case when tyb.horse_no = '02' then leg_info else '' end) as leg_info_02,
max(case when tyb.horse_no = '03' then leg_info else '' end) as leg_info_03,
max(case when tyb.horse_no = '04' then leg_info else '' end) as leg_info_04,
max(case when tyb.horse_no = '05' then leg_info else '' end) as leg_info_05,
max(case when tyb.horse_no = '06' then leg_info else '' end) as leg_info_06,
max(case when tyb.horse_no = '07' then leg_info else '' end) as leg_info_07,
max(case when tyb.horse_no = '08' then leg_info else '' end) as leg_info_08,
max(case when tyb.horse_no = '09' then leg_info else '' end) as leg_info_09,
max(case when tyb.horse_no = '10' then leg_info else '' end) as leg_info_10,
max(case when tyb.horse_no = '11' then leg_info else '' end) as leg_info_11,
max(case when tyb.horse_no = '12' then leg_info else '' end) as leg_info_12,
max(case when tyb.horse_no = '13' then leg_info else '' end) as leg_info_13,
max(case when tyb.horse_no = '14' then leg_info else '' end) as leg_info_14,
max(case when tyb.horse_no = '15' then leg_info else '' end) as leg_info_15,
max(case when tyb.horse_no = '16' then leg_info else '' end) as leg_info_16,
max(case when tyb.horse_no = '17' then leg_info else '' end) as leg_info_17,
max(case when tyb.horse_no = '18' then leg_info else '' end) as leg_info_18,
max(case when tyb.horse_no = '01' then tyb.apprentice_type else '' end) as apprentice_type_01,
max(case when tyb.horse_no = '02' then tyb.apprentice_type else '' end) as apprentice_type_02,
max(case when tyb.horse_no = '03' then tyb.apprentice_type else '' end) as apprentice_type_03,
max(case when tyb.horse_no = '04' then tyb.apprentice_type else '' end) as apprentice_type_04,
max(case when tyb.horse_no = '05' then tyb.apprentice_type else '' end) as apprentice_type_05,
max(case when tyb.horse_no = '06' then tyb.apprentice_type else '' end) as apprentice_type_06,
max(case when tyb.horse_no = '07' then tyb.apprentice_type else '' end) as apprentice_type_07,
max(case when tyb.horse_no = '08' then tyb.apprentice_type else '' end) as apprentice_type_08,
max(case when tyb.horse_no = '09' then tyb.apprentice_type else '' end) as apprentice_type_09,
max(case when tyb.horse_no = '10' then tyb.apprentice_type else '' end) as apprentice_type_10,
max(case when tyb.horse_no = '11' then tyb.apprentice_type else '' end) as apprentice_type_11,
max(case when tyb.horse_no = '12' then tyb.apprentice_type else '' end) as apprentice_type_12,
max(case when tyb.horse_no = '13' then tyb.apprentice_type else '' end) as apprentice_type_13,
max(case when tyb.horse_no = '14' then tyb.apprentice_type else '' end) as apprentice_type_14,
max(case when tyb.horse_no = '15' then tyb.apprentice_type else '' end) as apprentice_type_15,
max(case when tyb.horse_no = '16' then tyb.apprentice_type else '' end) as apprentice_type_16,
max(case when tyb.horse_no = '17' then tyb.apprentice_type else '' end) as apprentice_type_17,
max(case when tyb.horse_no = '18' then tyb.apprentice_type else '' end) as apprentice_type_18,
max(case when tyb.horse_no = '01' then tyb.odds_mark else '' end) as odds_mark_01,
max(case when tyb.horse_no = '02' then tyb.odds_mark else '' end) as odds_mark_02,
max(case when tyb.horse_no = '03' then tyb.odds_mark else '' end) as odds_mark_03,
max(case when tyb.horse_no = '04' then tyb.odds_mark else '' end) as odds_mark_04,
max(case when tyb.horse_no = '05' then tyb.odds_mark else '' end) as odds_mark_05,
max(case when tyb.horse_no = '06' then tyb.odds_mark else '' end) as odds_mark_06,
max(case when tyb.horse_no = '07' then tyb.odds_mark else '' end) as odds_mark_07,
max(case when tyb.horse_no = '08' then tyb.odds_mark else '' end) as odds_mark_08,
max(case when tyb.horse_no = '09' then tyb.odds_mark else '' end) as odds_mark_09,
max(case when tyb.horse_no = '10' then tyb.odds_mark else '' end) as odds_mark_10,
max(case when tyb.horse_no = '11' then tyb.odds_mark else '' end) as odds_mark_11,
max(case when tyb.horse_no = '12' then tyb.odds_mark else '' end) as odds_mark_12,
max(case when tyb.horse_no = '13' then tyb.odds_mark else '' end) as odds_mark_13,
max(case when tyb.horse_no = '14' then tyb.odds_mark else '' end) as odds_mark_14,
max(case when tyb.horse_no = '15' then tyb.odds_mark else '' end) as odds_mark_15,
max(case when tyb.horse_no = '16' then tyb.odds_mark else '' end) as odds_mark_16,
max(case when tyb.horse_no = '17' then tyb.odds_mark else '' end) as odds_mark_17,
max(case when tyb.horse_no = '18' then tyb.odds_mark else '' end) as odds_mark_18,
max(case when tyb.horse_no = '01' then tyb.paddock_mark else '' end) as paddock_mark_01,
max(case when tyb.horse_no = '02' then tyb.paddock_mark else '' end) as paddock_mark_02,
max(case when tyb.horse_no = '03' then tyb.paddock_mark else '' end) as paddock_mark_03,
max(case when tyb.horse_no = '04' then tyb.paddock_mark else '' end) as paddock_mark_04,
max(case when tyb.horse_no = '05' then tyb.paddock_mark else '' end) as paddock_mark_05,
max(case when tyb.horse_no = '06' then tyb.paddock_mark else '' end) as paddock_mark_06,
max(case when tyb.horse_no = '07' then tyb.paddock_mark else '' end) as paddock_mark_07,
max(case when tyb.horse_no = '08' then tyb.paddock_mark else '' end) as paddock_mark_08,
max(case when tyb.horse_no = '09' then tyb.paddock_mark else '' end) as paddock_mark_09,
max(case when tyb.horse_no = '10' then tyb.paddock_mark else '' end) as paddock_mark_10,
max(case when tyb.horse_no = '11' then tyb.paddock_mark else '' end) as paddock_mark_11,
max(case when tyb.horse_no = '12' then tyb.paddock_mark else '' end) as paddock_mark_12,
max(case when tyb.horse_no = '13' then tyb.paddock_mark else '' end) as paddock_mark_13,
max(case when tyb.horse_no = '14' then tyb.paddock_mark else '' end) as paddock_mark_14,
max(case when tyb.horse_no = '15' then tyb.paddock_mark else '' end) as paddock_mark_15,
max(case when tyb.horse_no = '16' then tyb.paddock_mark else '' end) as paddock_mark_16,
max(case when tyb.horse_no = '17' then tyb.paddock_mark else '' end) as paddock_mark_17,
max(case when tyb.horse_no = '18' then tyb.paddock_mark else '' end) as paddock_mark_18,
max(case when tyb.horse_no = '01' then tyb.just_before_info else '' end) as just_before_info_01,
max(case when tyb.horse_no = '02' then tyb.just_before_info else '' end) as just_before_info_02,
max(case when tyb.horse_no = '03' then tyb.just_before_info else '' end) as just_before_info_03,
max(case when tyb.horse_no = '04' then tyb.just_before_info else '' end) as just_before_info_04,
max(case when tyb.horse_no = '05' then tyb.just_before_info else '' end) as just_before_info_05,
max(case when tyb.horse_no = '06' then tyb.just_before_info else '' end) as just_before_info_06,
max(case when tyb.horse_no = '07' then tyb.just_before_info else '' end) as just_before_info_07,
max(case when tyb.horse_no = '08' then tyb.just_before_info else '' end) as just_before_info_08,
max(case when tyb.horse_no = '09' then tyb.just_before_info else '' end) as just_before_info_09,
max(case when tyb.horse_no = '10' then tyb.just_before_info else '' end) as just_before_info_10,
max(case when tyb.horse_no = '11' then tyb.just_before_info else '' end) as just_before_info_11,
max(case when tyb.horse_no = '12' then tyb.just_before_info else '' end) as just_before_info_12,
max(case when tyb.horse_no = '13' then tyb.just_before_info else '' end) as just_before_info_13,
max(case when tyb.horse_no = '14' then tyb.just_before_info else '' end) as just_before_info_14,
max(case when tyb.horse_no = '15' then tyb.just_before_info else '' end) as just_before_info_15,
max(case when tyb.horse_no = '16' then tyb.just_before_info else '' end) as just_before_info_16,
max(case when tyb.horse_no = '17' then tyb.just_before_info else '' end) as just_before_info_17,
max(case when tyb.horse_no = '18' then tyb.just_before_info else '' end) as just_before_info_18
from
`yu-it-base.jrdb_raw_data.a_bac` bac
inner join `yu-it-base.jrdb_raw_data.a_kab` kab  on
    bac.partitioning_date = kab.partitioning_date
    and bac.race_key_place_code = kab.held_key_place_code
inner join `yu-it-base.jrdb_raw_data.a_kyi` kyi  on
    bac.partitioning_date = kyi.partitioning_date
    and bac.race_key_place_code = kyi.race_key_place_code
    and bac.race_key_round = kyi.race_key_round
inner join  `yu-it-base.jrdb_raw_data_schema_info.category_mst` cat_place
    on
    cat_place.table_name = 'a_kyi' and cat_place.column_pysical_name = 'race_key_place_code'
    and cat_place.category = kyi.race_key_place_code 
inner join `yu-it-base.jrdb_raw_data.a_sed` sed  on
    bac.partitioning_date = sed.partitioning_date
    and bac.race_key_place_code = sed.race_key_place_code
    and bac.race_key_round = sed.race_key_round
    and kyi.horse_no = sed.horse_no
left join `yu-it-base.jrdb_raw_data.a_tyb` tyb  on
    bac.partitioning_date = tyb.partitioning_date
    and bac.race_key_place_code = tyb.race_key_place_code
    and bac.race_key_round = tyb.race_key_round
    and kyi.horse_no = tyb.horse_no
group by concat(format_datetime("%F",bac.date),"_",kyi.race_key_place_code,kyi.race_key_round) ,kyi.race_key_place_code,kyi.race_key_year,kyi.race_key_no,kyi.race_key_day,kyi.race_key_round

